<?php

function hirudo_install() {

    $type = node_type_set_defaults();

    $type->type = "hirudo";
    $type->name = "Hirudo";
    $type->orig_type = "hirudo";

    $type->description = "Hirudo PHP Web framework";
    $type->help = "Please, avoid using this node type to create content as it exists only to hold the Hirudo App.";
    $type->title_label = "";
    $type->has_title = false;

    $type->base = 'node_content';
    $type->custom = true;
    $type->locked = true;
    $type->module = true;

    node_type_save($type);


    $fakeNode = new stdClass();
    $fakeNode->uid = 1;
    $fakeNode->status = 1;
    $fakeNode->type = "hirudo";
    $fakeNode->language = "und";
    $fakeNode->name = "JeyDotC";
    $fakeNode->is_new = true;

    node_save($fakeNode);

    if (drupal_lookup_path("source", "App") === false) {
        $newPath = array(
            "source" => "node/{$fakeNode->nid}",
            "alias" => "App"
        );
        path_save($newPath);
    }
}

function hirudo_uninstall() {
    $result = db_query("SELECT nid FROM node WHERE type = :type", array(
        "type" => "hirudo"
    ));

    $nids = array();
    foreach ($result as $obj) {
        $nids[] = $obj->nid;
    }

    node_delete_multiple($nids);
    node_type_delete("hirudo");
}

?>
